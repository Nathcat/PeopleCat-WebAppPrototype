<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<link id="icon" rel="icon" href="/images?path=favicon.png" />
	<title>PeopleCat</title>

	<link rel="stylesheet" href="/styles?path=common.css" />
	<script src="/script?path=Packet.js"></script>
	<script src="/script?path=application.js"></script>
	<script src="/script?path=login.js"></script>
	<script src="/script?path=messenger.js"></script>
</head>

<body>
	<div id="page-content" class="content"></div>

	<script>
		const app = new Application();
		app.load_page(() => {
			document.getElementById("login_username_entry").onkeydown = (e) => {
				if (e.key == "Enter") attempt_login();
			};

			document.getElementById("login_password_entry").onkeydown = (e) => {
				if (e.key == "Enter") attempt_login();
			};

			fetch("https://data.nathcat.net/sso/get-session.php", {
				method: "GET",
				headers: {
					"Cookie": document.cookie
				}
			})
			.then((r) => r.json()).then((r) => {
				console.log(r);
				if ("user" in r) {
					app.data.user = r["user"];
					app.page = new Page(Page.PAGE_MAIN);
					app.load_page(setup_messenger);
				}
				else {
					console.log("Invalid session!");
				}
			});
		});
	</script>
</body>

</html>